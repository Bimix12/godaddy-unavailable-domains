<script>
  async function checkDomains() {
    const rawDomains = document.getElementById('domainInput').value.split('\n').map(x => x.trim()).filter(Boolean);
    const resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = 'Checking...';

    const chunks = [];
    for (let i = 0; i < rawDomains.length; i += 500) {
      chunks.push(rawDomains.slice(i, i + 500));
    }

    let unavailableDomains = [];

    for (const chunk of chunks) {
      const res = await fetch("https://api.godaddy.com/v1/domains/available", {
        method: "POST",
        headers: {
          "Authorization": "sso-key dLYuzkosMXb5_5w8r1GAw2ES94SwM4onm5a:5UDQgP3bPRc6EoijADcqic",
          "Content-Type": "application/json",
          "Accept": "application/json"
        },
        body: JSON.stringify({
          domainNames: chunk,
          checkType: "FAST"
        })
      });

      if (!res.ok) {
        resultsDiv.innerHTML = `<p style="color:red">Error: ${res.status} - ${res.statusText}</p>`;
        return;
      }

      const data = await res.json();

      for (const domain of data.domains) {
        if (!domain.available) {
          unavailableDomains.push(domain.domain);
        }
      }
    }

    resultsDiv.innerHTML = `<h3>Unavailable Domains (${unavailableDomains.length})</h3><pre>${unavailableDomains.join('\n')}</pre>`;
  }
</script>
